# 学術論文管理システム ユーザーマニュアル

バージョン 1.0.0

---

## 目次

1. [はじめに](#1-はじめに)
2. [画面構成](#2-画面構成)
3. [基本操作](#3-基本操作)
4. [検索機能](#4-検索機能)
5. [データ管理](#5-データ管理)
6. [よくある質問](#6-よくある質問)
7. [トラブルシューティング](#7-トラブルシューティング)

---

## 1. はじめに

### 1.1 このアプリケーションについて

学術論文管理システムは、研究者や学生が論文を効率的に管理するためのデスクトップアプリケーションです。

**できること:**
- 論文情報の登録・編集・削除
- PDFファイルと画像の添付
- 強力な検索機能
- PDFのプレビュー表示
- データのバックアップとエクスポート

### 1.2 推奨される使用環境

- **OS**: Windows 10/11
- **メモリ**: 8GB以上
- **ディスプレイ**: 1280x720 以上
- **ストレージ**: 1GB以上の空き容量

---

## 2. 画面構成

### 2.1 メインウィンドウ

```
+----------------------------------------------------------+
| [メニューバー]                                            |
+----------------------------------------------------------+
| [🔍 検索] [フィールド▼] [キーワード入力] [検索] [詳細] [クリア] |
+----------------------------------------------------------+
| [➕新規] [✏️編集] [🗑️削除] [↻更新]                         |
+----------------------------------------------------------+
| ID | タイトル | 著者 | 年 | 登録日 | 更新日              |
|---------------------------------------------------------|
| 1  | Deep Learning | Hinton | 2015 | 2024-12 | 2024-12|
| 2  | Transformer   | Vaswani| 2017 | 2024-12 | 2024-12|
+----------------------------------------------------------+
| 表示: 2件 / 全2件                                         |
+----------------------------------------------------------+
```

#### メニューバー

- **ファイル(F)**: 新規登録、エクスポート、インポート、バックアップ、終了
- **編集(E)**: 編集、削除
- **表示(V)**: 更新
- **ヘルプ(H)**: バージョン情報

#### 検索バー

- **検索フィールド**: タイトル、著者、メモ、全体から選択
- **キーワード入力**: 検索したい文字列を入力
- **詳細検索**: 複数条件での検索ダイアログを開く
- **クリア**: 検索結果をクリアして全件表示

#### ツールバー

- **➕ 新規登録**: 論文登録ダイアログを開く
- **✏️ 編集**: 選択中の論文を編集
- **🗑️ 削除**: 選択中の論文を削除
- **↻ 更新**: リストを最新の状態に更新

#### 論文リスト（テーブル）

- **列ヘッダークリック**: その列でソート（再クリックで昇順/降順切り替え）
- **行選択**: 論文を選択
- **ダブルクリック**: 詳細表示ダイアログを開く

---

## 3. 基本操作

### 3.1 論文の登録

#### 手順

1. **新規登録ダイアログを開く**
   - `Ctrl+N` キーを押す、または
   - ツールバーの **➕ 新規登録** ボタンをクリック、または
   - メニューバー → **ファイル** → **新規登録**

2. **基本情報を入力**
   - **タイトル** (必須): 論文のタイトルを入力
   - **著者**: 著者名を入力（複数著者の場合は「, 」で区切る）
   - **年**: 発行年を選択（未設定も可能）

3. **ファイルを選択（オプション）**
   - **PDF**: 📁参照ボタンでPDFファイルを選択
   - **画像**: 📁参照ボタンで画像ファイルを選択
   - 画像を選択すると自動的にプレビューが表示されます

4. **メモを入力（オプション）**
   - 論文の要約や重要なポイントを記入

5. **保存**
   - **💾 保存** ボタンをクリック

#### 注意点

- タイトルは必須項目です
- PDFと画像は実ファイルではなく、パスのみが保存されます
- ファイルを移動すると、リンクが切れます

### 3.2 論文の編集

#### 手順

1. **論文を選択**
   - テーブルで編集したい論文をクリック

2. **編集ダイアログを開く**
   - `Ctrl+E` キーを押す、または
   - ツールバーの **✏️ 編集** ボタンをクリック

3. **情報を修正**
   - 変更したい項目を編集

4. **保存**
   - **💾 保存** ボタンをクリック

### 3.3 論文の削除

#### 手順

1. **論文を選択**
   - テーブルで削除したい論文をクリック

2. **削除を実行**
   - `Delete` キーを押す、または
   - ツールバーの **🗑️ 削除** ボタンをクリック

3. **確認**
   - 確認ダイアログが表示されるので、**はい** をクリック

#### ⚠️ 警告

削除した論文は復元できません。重要な論文を削除する前に、必ずバックアップを取ってください。

### 3.4 詳細表示

#### 手順

1. **論文をダブルクリック**
   - テーブルで論文をダブルクリック

2. **タブで情報を確認**
   - **📋 基本情報**: ID、タイトル、著者、年、登録日、更新日
   - **📝 メモ**: 登録したメモ
   - **👁️ プレビュー**: PDFまたは画像のプレビュー
   - **ℹ️ メタデータ**: ファイル情報、PDFメタデータ

3. **ファイルを開く**
   - **📄 開く** ボタンでPDFを外部アプリで開く
   - **🖼️ 開く** ボタンで画像を外部アプリで開く

4. **編集へ移動**
   - **✏️ 編集** ボタンで編集ダイアログを開く

---

## 4. 検索機能

### 4.1 簡易検索

#### 使い方

1. **検索フィールドを選択**
   - タイトル、著者、メモ、全体から選択

2. **キーワードを入力**
   - 部分一致で検索されます
   - 例: "Deep" → "Deep Learning"、"Deeper Networks" などがヒット

3. **検索実行**
   - `Enter` キーを押す、または
   - **検索** ボタンをクリック

4. **結果の確認**
   - 該当する論文のみがテーブルに表示されます
   - ステータスバーに検索結果の件数が表示されます

5. **検索をクリア**
   - **クリア** ボタンで全件表示に戻る

#### 検索フィールドの説明

| フィールド | 検索対象 |
|-----------|---------|
| タイトル | 論文のタイトルのみ |
| 著者 | 著者名のみ |
| メモ | メモ欄の内容のみ |
| 全体 | タイトル、著者、メモすべて |

### 4.2 詳細検索

#### 使い方

1. **詳細検索ダイアログを開く**
   - 検索バーの **詳細検索...** ボタンをクリック

2. **検索条件を入力**
   - **タイトル**: タイトルに含まれるキーワード
   - **著者**: 著者名
   - **年**: 開始年 ～ 終了年
   - **メモ**: メモに含まれるキーワード

3. **検索実行**
   - **🔍 検索** ボタンをクリック

4. **結果の確認**
   - 全条件に一致する論文が表示されます（AND検索）

#### 検索例

**例1: 2015年から2020年の間に発表された機械学習の論文**
- タイトル: `機械学習`
- 年: `2015` ～ `2020`

**例2: 特定の著者の論文**
- 著者: `Hinton`

**例3: メモに「重要」と書いた論文**
- メモ: `重要`

---

## 5. データ管理

### 5.1 バックアップ

#### 自動バックアップ

アプリ起動時に自動的にバックアップが作成されます。

- **保存場所**: `data/backups/papers_auto_YYYYMMDD_HHMMSS.db`
- **世代数**: 最新5世代を保持
- **動作**: 起動時に自動実行

#### 手動バックアップ

1. メニューバー → **ファイル** → **バックアップ**
2. バックアップが作成されます
3. 成功メッセージとファイルパスが表示されます

#### バックアップからの復元

**方法1: 手動復元**
1. `data/backups/` フォルダを開く
2. 復元したいバックアップファイル（`papers_auto_*.db`）を見つける
3. `data/papers.db` を別の場所に移動（念のため保存）
4. バックアップファイルを `data/papers.db` にリネームしてコピー
5. アプリを再起動

### 5.2 CSVエクスポート

#### 使い方

1. メニューバー → **ファイル** → **CSVエクスポート**
2. 保存先を選択
3. ファイル名を入力（デフォルト: `papers_export_YYYYMMDD_HHMMSS.csv`）
4. **保存** ボタンをクリック

#### エクスポートされるデータ

全論文の以下の情報がCSVに出力されます：
- ID
- タイトル
- 著者
- 年
- PDFパス
- 画像パス
- メモ
- 登録日
- 更新日

#### Excelでの編集

エクスポートされたCSVはExcelで直接開くことができます（UTF-8 BOM付き）。

### 5.3 CSVインポート

#### 使い方

1. メニューバー → **ファイル** → **CSVインポート**
2. インポートするCSVファイルを選択
3. 確認ダイアログで **はい** をクリック
4. インポート結果が表示されます

#### 注意点

- 既存のデータは削除されません（追加のみ）
- 同じ論文を重複してインポートすると、別のIDで登録されます
- CSVのフォーマットはエクスポート形式に合わせてください

#### CSVフォーマット

```csv
id,title,author,year,pdf_path,image_path,memo,created_at,updated_at
1,Deep Learning,Geoffrey Hinton,2015,C:\papers\deep.pdf,C:\images\deep.png,重要な論文,2024-12-01 10:00:00,2024-12-01 10:00:00
```

---

## 6. よくある質問

### Q1. PDFファイルを登録後に移動してしまいました

**A:** PDFパスが無効になります。以下の対処法があります：
1. PDFファイルを元の場所に戻す
2. 論文を編集して、新しいPDFパスを設定する

### Q2. 大量の論文を一度に登録したい

**A:** CSVインポート機能を使用してください：
1. Excelで論文リストを作成
2. CSV形式で保存（UTF-8）
3. CSVインポート機能で読み込む

### Q3. データベースファイルはどこにありますか？

**A:** `data/papers.db` にあります。このファイルをコピーすればバックアップになります。

### Q4. 別のPCでもデータを使いたい

**A:** 以下の方法があります：
1. `data/papers.db` ファイルをコピーして別PCの同じ場所に配置
2. CSVエクスポート → 別PCでCSVインポート

### Q5. 検索が遅い

**A:** 10,000件以上登録している場合、以下を試してください：
1. 詳細検索で条件を絞る
2. データベースファイルを最適化（定期的な再起動）

### Q6. PDFプレビューが表示されない

**A:** 以下を確認してください：
1. PDFファイルが存在するか
2. PDFファイルが破損していないか
3. PyMuPDFが正しくインストールされているか

---

## 7. トラブルシューティング

### 問題1: アプリが起動しない

**症状:** ダブルクリックしても何も起こらない

**原因と対処法:**

1. **Pythonがインストールされていない**
   ```bash
   python --version
   ```
   → 3.9以上をインストール

2. **依存パッケージが不足**
   ```bash
   pip install -r requirements.txt
   ```

3. **仮想環境が有効化されていない**
   ```bash
   venv\Scripts\activate
   ```

### 問題2: データベースエラー

**症状:** 「データベースエラー」というメッセージが表示される

**対処法:**

1. **バックアップから復元**
   - `data/backups/` から最新のファイルを探す
   - `data/papers.db` に上書きコピー

2. **データベースファイルを削除して再作成**
   - `data/papers.db` を削除
   - アプリを再起動（空のデータベースが作成される）

### 問題3: PDFプレビューが機能しない

**症状:** プレビュータブが真っ白、またはエラーメッセージ

**対処法:**

1. **PyMuPDFの再インストール**
   ```bash
   pip uninstall PyMuPDF
   pip install PyMuPDF
   ```

2. **PDFファイルの確認**
   - PDFファイルが破損していないか確認
   - Adobe Readerなどで開けるか確認

### 問題4: メモリ不足エラー

**症状:** 大量の論文を登録すると動作が遅くなる

**対処法:**

1. **不要な論文を削除**
2. **データベースを分割**（年代別など）
3. **PCのメモリを増設**

### 問題5: CSV文字化け

**症状:** ExcelでCSVを開くと日本語が文字化けする

**対処法:**

1. **メモ帳で開いて再保存**
   - CSVをメモ帳で開く
   - 名前を付けて保存 → エンコード: UTF-8

2. **Excelのインポート機能を使用**
   - Excel起動 → データ → テキストから
   - エンコード: UTF-8を選択

---

## 8. アップデート情報

### バージョン 1.0.0 (2024-12-12)

**初回リリース**
- 基本的なCRUD機能
- 検索機能
- PDFプレビュー
- 自動バックアップ
- CSV入出力

---

## 9. お問い合わせ

質問や不具合の報告は以下へお願いします：

- **GitHub Issues**: https://github.com/yourusername/paper_manager/issues
- **メール**: your.email@example.com

---

**このマニュアルは随時更新されます。最新版はGitHubでご確認ください。**